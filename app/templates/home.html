{% extends 'base.html' %}
{% block title %} Home {% endblock %}
{% block content %}

{% if message %}
<div class="alert alert-primary" role="alert">
	{{ message }}
 </div>
{% endif %}

{% if current_user.is_authenticated %}
<a href="{{url_for('new_post')}}" class="btn btn-primary offset-5"> New Post</a>

<div id="posts">
			
{% for post in posts %}
	<br>
	<div class="post">
		<h2 class=""><a href="{{ url_for('show_post', post_id=post.id) }}">{{post.title}}</a></h2>
		<p>{{post.body}}</p>

		{% if current_user.has_liked(post) %}
		<p class="unlike">
			<a href="{{ url_for('like_action', post_id=post.id, action='unlike') }}" class="fas fa-heart"></a><span style="margin-left: 5px;">{{ post.likes.count() }}</span>
			<a href="{{ url_for('show_post', post_id=post.id)}}" class="far fa-comment"></a><span style="margin-left: 5px;">{{ post.comments.count() }} comments </span>
		</p>
		{% else %}
		<p class="like">
			<a href="{{ url_for('like_action', post_id=post.id, action='like') }}" class="far fa-heart"></a><span style="margin-left: 5px;">{{ post.likes.count() }}</span>
			<a href="{{ url_for('show_post', post_id=post.id)}}" class="far fa-comment"></a><span style="margin-left: 5px;">{{ post.comments.count() }} comments </span>
		</p>
		{% endif %}

		{% if current_user.id == post.posted_by %}
		<h6><a href="{{url_for('delete_post', post_id = post.id)}}" class="float-right">&emsp; Delete</a></h6>
		<h6><a href="{{url_for('edit_post', post_id = post.id)}}" class="float-right"> Edit</a></h6>
		{% endif %}

		<p><h6> Posted by: <a href="{{url_for('show_user', username = post.username)}}">{{ post.username }}</a></h6></p>
	</div>
				
{% endfor %}

{% if prev_url %}
<a href="{{ prev_url }}">Newer posts</a>
{% endif %}

{% if next_url %}
<a href="{{ next_url }}">Older posts</a>
{% endif %}

</div>

{% else %}
	<div class="jumbotron">
		<h1 class="text-center">Welcome to Micro-Posting</h1>
		<a href="{{url_for('signup')}}" class="btn btn-lg btn-primary offset-5"> Sign Up</a>
	</div>
{% endif %}
{% endblock %}