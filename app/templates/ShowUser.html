{% extends "base.html" %}

{% block title %} {{ user.username }}'s Profile {% endblock %}

{% block content %}

<img src="{{ user.avatar(100) }}" class="float-left" style="margin-right: 5px">
<h1> {{ user.username }}'s Profile </h1>
{% if current_user.id == user.id %}
<h6><a href="https://gravatar.com/emails" target="_blank">Change Avatar</a></h6>
<h6><a href="{{url_for('edit_user', user_id = current_user.id)}}"> Change Password</a></h6>
{% endif %}

<div id="posts">
	{% for post in posts %}
	<br>
	<div class="post">

		<h2 class=""><a href="{{ post.public_url() }}">{{post.title}}</a></h2>
		<p>{{post.body}}</p>

		{% if current_user.has_liked(post) %}
		<p class="unlike">
			<a href="{{ url_for('like_action', post_id=post.id, action='unlike') }}" class="fas fa-heart"></a><span style="margin-left: 5px;">{{ post.likes.count() }}</span>
			<a href="{{ post.public_url() }}" class="far fa-comment"></a><span style="margin-left: 5px;">{{ post.comments.count() }} comments </span>
		</p>
		{% else %}
		<p class="like">
			<a href="{{ url_for('like_action', post_id=post.id, action='like') }}" class="far fa-heart"></a><span style="margin-left: 5px;">{{ post.likes.count() }}</span>
			<a href="{{ post.public_url() }}" class="far fa-comment"></a><span style="margin-left: 5px;">{{ post.comments.count() }} comments </span>
		</p>
		{% endif %}

		<p>
			{% if current_user.id == post.posted_by %}
			<h6><a href="{{url_for('delete_post', post_id = post.id)}}" class="float-right">&emsp; Delete</a></h6>
			<h6><a href="{{url_for('edit_post', post_id = post.id)}}" class="float-right"> Edit</a></h6>
			{% endif %}
			<h6>Created {{ moment(post.created).fromNow() }} </h6>
		</p>


	</div>
				
	{% endfor %}

	<nav aria-label="Page navigation">
		<ul class="pagination">
		{% if prev_url %}
    	<li class="page-item"><a class="page-link" href="{{ prev_url }}">Newer posts</a></li>
    	{% endif %}
    	{% if next_url %}
    	<li class="page-item"><a class="page-link" href="{{ next_url }}">Older posts</a></li>
    	{% endif %}
		</ul>
	</nav>
</div>

{% endblock %}