{% extends 'base.html' %}

{% block title %} {{post.title}} {% endblock %}

{% block content %}
	<div id="show">
    <div class="post">
        <h2>{{ post.title }}</h2>

		<p>{{post.body}}</p>

		{% if current_user.has_liked(post) %}
		<p class="unlike">
			<a href="{{ url_for('like_action', post_id=post.id, action='unlike') }}" class="fas fa-heart"></a><span style="margin-left: 5px;">{{ post.likes.count() }}</span>
		</p>
		{% else %}
		<p class="like">
			<a href="{{ url_for('like_action', post_id=post.id, action='like') }}" class="far fa-heart"></a><span style="margin-left: 5px;">{{ post.likes.count() }}</span>
		</p>
		{% endif %}

        <p>
            {% if current_user.id == post.posted_by %}
            <h6><a href="{{url_for('delete_post', post_id = post.id)}}" class="float-right">&emsp; Delete</a></h6>
            <h6><a href="{{url_for('edit_post', post_id = post.id)}}" class="float-right"> Edit</a></h6>
            {% endif %}
            <h6> Posted by: <a href="{{url_for('show_user', username = post.username)}}">{{ post.username }}</a> <span> Created at {{post.created}} </span></h6>
            
        </p>
    </div>
	</div>
    <p> Comments ({{post.comments.count()}}) </p>
    <div class="post">
    	<form action="{{ post.public_url() }}" method="POST">
    	{{ form.body }} <br>
    	{{ form.csrf_token }}
        {{ form.submit(class = 'btn btn-primary')}}
    	</form>
    </div>
    <br>
    <div id="comments">
    {% for comment in comments %}
    	<div class="comment">
    		<p>
    			{{ comment.body }}
    		</p>
    		{% if current_user.id == comment.user_id %}
			<h6><a href="{{url_for('delete_comment', comment_id = comment.id)}}" class="float-right">&emsp; Delete</a></h6>
			{% endif %}
    		<p>
                <h6> 
                    Commented by: <a href="{{url_for('show_user', username = comment.username)}}">{{ comment.username }}</a>
                    <span> Created at: {{comment.created}}</span>
                </h6>
            </p>

    	</div>
    {% endfor %}
	</div>

	{% if prev_url %}
    <a href="{{ prev_url }}">Newer comments</a>
    {% endif %}
    {% if next_url %}
    <a href="{{ next_url }}">Older comments</a>
    {% endif %}
{% endblock %}